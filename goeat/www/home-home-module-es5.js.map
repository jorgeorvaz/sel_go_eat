{"version":3,"sources":["webpack:///src/app/home/home.page.html","webpack:///src/app/home/home-routing.module.ts","webpack:///src/app/home/home.module.ts","webpack:///src/app/home/home.page.scss","webpack:///src/app/home/home.page.ts","webpack:///src/app/home/restaurante.model.ts"],"names":["routes","path","component","HomePageRoutingModule","imports","forChild","exports","HomePageModule","declarations","HomePage","afDB","navCtrl","authService","geolocation","plt","alertCtrl","toastCtrl","iab","count_position","place_markers","locales_places","usuario","restaurant","isError","isLogged","mostrar","map","google","maps","Map","home","Marker","infowindow","InfoWindow","isTracking","trackedRoute","currentMapTrack","start","end","direction","DirectionsResult","loadMap","loadUserPosition","userDetails","subscribe","res","userEmail","email","navigateBack","err","console","log","logoutUser","then","error","latLng","LatLng","styles","MapTypeStyle","featureType","stylers","visibility","mapOptions","MapOptions","center","zoom","mapTypeId","MapTypeId","ROADMAP","mapTypeControl","mapElement","nativeElement","ready","getCurrentPosition","resp","lat","coords","latitude","lng","longitude","focusMap","addMarker","setCenter","setZoom","info","position","animation","Animation","DROP","icon","infoWindow","content","addListener","open","setMap","length","marker","getAnimation","setAnimation","BOUNCE","my_coords","navigator","local","remove_place_markers","request","places","PlaceSearchRequest","type","radius","location","getPosition","service","PlacesService","nearbySearch","results","status","distance_order","lista_rest","PlacesServiceStatus","OK","place","addNearbyMarker","e","query","detail","value","textSearch","PlaceResult","url","scaledSize","Size","origin","Point","anchor","geometry","push","distancia","getDistanceFromLatLonInMeters","photo","photos","getUrl","maxWidth","maxHeight","setContent","name","vicinity","create","duration","message","toast","positionSubscription","watchPosition","data","redrawPath","present","Polyline","geodesic","strokeColor","strokeOpacity","strokeWeight","unsubscribe","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","a","Math","sin","cos","c","atan2","sqrt","d","round","deg","PI","rest","id","ocupacion","insertar_restaurante","borrar_ocupacion","my_lat","my_lng","lugares","i","j","aux","valoracion","rating","database","ref","once","snapshot","val","read","selector","template","Restaurante"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACIf,QAAMA,MAAM,GAAW,CACrB;AACEC,UAAI,EAAE,EADR;AAEEC,eAAS,EAAE;AAFb,KADqB,CAAvB;;AAWA,QAAaC,qBAAqB;AAAA;AAAA,KAAlC;;AAAaA,yBAAqB,6DAJjC,+DAAS;AACRC,aAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,aAAO,EAAE,CAAC,4DAAD;AAFD,KAAT,CAIiC,GAArBH,qBAAqB,CAArB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCb,QAAaI,cAAc;AAAA;AAAA,KAA3B;;AAAaA,kBAAc,6DAT1B,+DAAS;AACRH,aAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,0EAJO,CADD;AAORI,kBAAY,EAAE,CAAC,mDAAD;AAPN,KAAT,CAS0B,GAAdD,cAAc,CAAd;;;;;;;;;;;;;;;;AChBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsBf,QAAaE,QAAQ;AA8BnB,wBACSC,IADT,EAEUC,OAFV,EAGUC,WAHV,EAIUC,WAJV,EAKUC,GALV,EAMUC,SANV,EAOUC,SAPV,EAQUC,GARV,EAQ2B;AAAA;;AAPlB,aAAAP,IAAA,GAAAA,IAAA;AACC,aAAAC,OAAA,GAAAA,OAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AACA,aAAAC,WAAA,GAAAA,WAAA;AACA,aAAAC,GAAA,GAAAA,GAAA;AACA,aAAAC,SAAA,GAAAA,SAAA;AACA,aAAAC,SAAA,GAAAA,SAAA;AACA,aAAAC,GAAA,GAAAA,GAAA;AApCV,aAAAC,cAAA,GAAqB,CAArB;AAKA,aAAAC,aAAA,GAA4B,EAA5B;AACA,aAAAC,cAAA,GAA6B,EAA7B;AACA,aAAAC,OAAA,GAAmB,IAAI,+DAAJ,EAAnB;AACA,aAAAC,UAAA,GAA0B,IAAI,8DAAJ,EAA1B;AACO,aAAAC,OAAA,GAAU,KAAV;AACA,aAAAC,QAAA,GAAW,KAAX;AACA,aAAAC,OAAA,GAAU,IAAV;AAGP,aAAAC,GAAA,GAAMC,MAAM,CAACC,IAAP,CAAYC,GAAlB;AACA,aAAAC,IAAA,GAAOH,MAAM,CAACC,IAAP,CAAYG,MAAnB;AACA,aAAAC,UAAA,GAAa,IAAIL,MAAM,CAACC,IAAP,CAAYK,UAAhB,EAAb;AACA,aAAAC,UAAA,GAAa,KAAb;AACA,aAAAC,YAAA,GAAe,EAAf;AACA,aAAAC,eAAA,GAAkB,IAAlB;AAIA,aAAAC,KAAA,GAAQ,EAAR;AACA,aAAAC,GAAA,GAAM,EAAN;AACA,aAAAC,SAAA,GAAYZ,MAAM,CAACC,IAAP,CAAYY,gBAAxB;AAYO;;AAvCY;AAAA;AAAA,0CAyCD;AAChB,eAAKC,OAAL;AACA,eAAKC,gBAAL;AACD;AA5CkB;AAAA;AAAA,mCA8CR;AAAA;;AAET,eAAK9B,WAAL,CAAiB+B,WAAjB,GAA+BC,SAA/B,CAAyC,UAAAC,GAAG,EAAI;AAC9C,gBAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB,mBAAI,CAACC,SAAL,GAAiBD,GAAG,CAACE,KAArB;AACD,aAFD,MAEO;AACL,mBAAI,CAACpC,OAAL,CAAaqC,YAAb,CAA0B,EAA1B;AACD;AACF,WAND,EAMG,UAAAC,GAAG,EAAI;AACRC,mBAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBF,GAAnB;AACD,WARD;AASD;AAzDkB;AAAA;AAAA,iCA0DV;AAAA;;AACP,eAAKrC,WAAL,CAAiBwC,UAAjB,GACGC,IADH,CACQ,UAAAR,GAAG,EAAI;AACXK,mBAAO,CAACC,GAAR,CAAYN,GAAZ;;AACA,kBAAI,CAAClC,OAAL,CAAaqC,YAAb,CAA0B,EAA1B;AACD,WAJH,WAKS,UAAAM,KAAK,EAAI;AACdJ,mBAAO,CAACC,GAAR,CAAYG,KAAZ;AACD,WAPH;AAQD;AAnEkB;AAAA;AAAA,kCAoET;AACR,cAAIC,MAAM,GAAG,IAAI5B,MAAM,CAACC,IAAP,CAAY4B,MAAhB,CAAuB,UAAvB,EAAmC,CAAC,SAApC,CAAb;AAEA,cAAIC,MAAM,GAAG9B,MAAM,CAACC,IAAP,CAAY8B,YAAZ,GAA2B,CACtC;AACEC,uBAAW,EAAE,KADf;AAEEC,mBAAO,EAAE,CACP;AACEC,wBAAU,EAAE;AADd,aADO;AAFX,WADsC,CAAxC;AAWA,cAAIC,UAAU,GAAGnC,MAAM,CAACC,IAAP,CAAYmC,UAAZ,GAAyB;AACxCC,kBAAM,EAAET,MADgC;AAExCU,gBAAI,EAAE,CAFkC;AAGxCC,qBAAS,EAAEvC,MAAM,CAACC,IAAP,CAAYuC,SAAZ,CAAsBC,OAHO;AAIxCX,kBAAM,EAAEA,MAJgC;AAKxCY,0BAAc,EAAE;AALwB,WAA1C;AAQA,eAAK3C,GAAL,GAAW,IAAIC,MAAM,CAACC,IAAP,CAAYC,GAAhB,CAAoB,KAAKyC,UAAL,CAAgBC,aAApC,EAAmDT,UAAnD,CAAX;AACD;AA3FkB;AAAA;AAAA,2CA6FA;AAAA;;AACjB,eAAKhD,GAAL,CAAS0D,KAAT,GAAiBnB,IAAjB,CAAsB,YAAM;AAC1B,kBAAI,CAACxC,WAAL,CAAiB4D,kBAAjB,GAAsCpB,IAAtC,CAA2C,UAAAqB,IAAI,EAAI;AACjD,kBAAMC,GAAG,GAAGD,IAAI,CAACE,MAAL,CAAYC,QAAxB;AACA,kBAAMC,GAAG,GAAGJ,IAAI,CAACE,MAAL,CAAYG,SAAxB;;AACA,oBAAI,CAACC,QAAL,CAAcL,GAAd,EAAmBG,GAAnB;;AACA,oBAAI,CAACG,SAAL,CACEN,GADF,EAEEG,GAFF,EAGE,aAHF;AAKD,aATD;AAUD,WAXD;AAYD;AA1GkB;AAAA;AAAA,iCA4GVH,GA5GU,EA4GLG,GA5GK,EA4GA;AACjB,cAAIvB,MAAM,GAAG,IAAI5B,MAAM,CAACC,IAAP,CAAY4B,MAAhB,CAAuBmB,GAAvB,EAA4BG,GAA5B,CAAb;AACA,eAAKpD,GAAL,CAASwD,SAAT,CAAmB3B,MAAnB;AACA,eAAK7B,GAAL,CAASyD,OAAT,CAAiB,EAAjB;AACD;AAhHkB;AAAA;AAAA,kCAkHTR,GAlHS,EAkHJG,GAlHI,EAkHCM,IAlHD,EAkHO;AAAA;;AACxB,cAAI7B,MAAM,GAAG,IAAI5B,MAAM,CAACC,IAAP,CAAY4B,MAAhB,CAAuBmB,GAAvB,EAA4BG,GAA5B,CAAb;AAEA,eAAKhD,IAAL,GAAY,IAAIH,MAAM,CAACC,IAAP,CAAYG,MAAhB,CAAuB;AACjCL,eAAG,EAAE,KAAKA,GADuB;AAEjC2D,oBAAQ,EAAE9B,MAFuB;AAGjC+B,qBAAS,EAAE3D,MAAM,CAACC,IAAP,CAAY2D,SAAZ,CAAsBC,IAHA;AAIjCC,gBAAI,EACF;AAL+B,WAAvB,CAAZ;AAQA,cAAIC,UAAU,GAAG,IAAI/D,MAAM,CAACC,IAAP,CAAYK,UAAhB,CAA2B;AAC1C0D,mBAAO,EAAEP;AADiC,WAA3B,CAAjB;AAGA,eAAKtD,IAAL,CAAU8D,WAAV,CAAsB,OAAtB,EAA+B,YAAM;AACnCF,sBAAU,CAACG,IAAX,CAAgB,MAAI,CAACnE,GAArB,EAA0B,MAAI,CAACI,IAA/B;AACD,WAFD;AAGD;AAnIkB;AAAA;AAAA,uCAqIJ;AACb,eAAKA,IAAL,CAAUgE,MAAV,CAAiB,IAAjB;AACD;AAvIkB;AAAA;AAAA,+CAyII;AACrB,cAAG,KAAK3E,aAAL,CAAmB4E,MAAnB,GAA4B,CAA/B,EAAiC;AAAA,uDACZ,KAAK5E,aADO;AAAA;;AAAA;AAC/B,kEAAsC;AAAA,oBAA7B6E,MAA6B;AACpCA,sBAAM,CAACF,MAAP,CAAc,IAAd;AACD;AAH8B;AAAA;AAAA;AAAA;AAAA;AAIhC;AAEF;AAhJkB;AAAA;AAAA,uCAkJJ;AACb,cAAI,KAAKhE,IAAL,CAAUmE,YAAV,OAA6B,IAAjC,EAAuC;AACrC,iBAAKnE,IAAL,CAAUoE,YAAV,CAAuB,IAAvB;AACD,WAFD,MAEO;AACL,iBAAKpE,IAAL,CAAUoE,YAAV,CAAuBvE,MAAM,CAACC,IAAP,CAAY2D,SAAZ,CAAsBY,MAA7C;AACD;AACF;AAxJkB;AAAA;AAAA,6CA0JU;AAC3B,cAAIC,SAAS,GAAc,EAA3B;;AACA,cAAI,iBAAiBC,SAArB,EAAgC;AAC9BA,qBAAS,CAACxF,WAAV,CAAsB4D,kBAAtB,CAAyC,UAACY,QAAD,EAAc;AACrDe,uBAAS,CAAC,CAAD,CAAT,GAAef,QAAQ,CAACT,MAAT,CAAgBC,QAA/B;AACAuB,uBAAS,CAAC,CAAD,CAAT,GAAef,QAAQ,CAACT,MAAT,CAAgBG,SAA/B;AAED,aAJD;AAKD;;AACD,iBAAOqB,SAAP;AACD;AApKkB;AAAA;AAAA,mCAsKRE,KAtKQ,EAsKD;AAAA;;AAChB,cAAG,KAAKnF,aAAR,EAAsB;AACpB,iBAAKoF,oBAAL;AACD;;AAED,cAAIC,OAAO,GAAG7E,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBC,kBAAnB,GAAwC;AACpDC,gBAAI,EAAE,CAACL,KAAD,CAD8C;AAEpDM,kBAAM,EAAE,GAF4C;AAGpDC,oBAAQ,EAAE,KAAK/E,IAAL,CAAUgF,WAAV;AAH0C,WAAtD;AAMA,cAAIC,OAAO,GAAG,IAAIpF,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBO,aAAvB,CAAqC,KAAKtF,GAA1C,CAAd;AACAqF,iBAAO,CAACE,YAAR,CAAqBT,OAArB,EAA8B,UAACU,OAAD,EAAUC,MAAV,EAAqB;AACjD,kBAAI,CAACV,MAAL,GAAYS,OAAZ;AACA,gBAAIV,OAAO,GAAG7E,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBC,kBAAnB,GAAwC;AACpDG,sBAAQ,EAAE,MAAI,CAAC/E,IAAL,CAAUgF,WAAV;AAD0C,aAAtD,CAFiD,CAKjD;;AAEA,kBAAI,CAACL,MAAL,GAAc,MAAI,CAACW,cAAL,CAAoBZ,OAAO,CAACK,QAAR,CAAiBlC,GAAjB,EAApB,EAA4C6B,OAAO,CAACK,QAAR,CAAiB/B,GAAjB,EAA5C,EAAoE,MAAI,CAAC2B,MAAzE,CAAd;;AACA,kBAAI,CAACY,UAAL,GARiD,CASjD;;;AACA,gBAAIF,MAAM,KAAKxF,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBa,mBAAnB,CAAuCC,EAAtD,EAA0D;AAAA,0DACtCL,OADsC;AAAA;;AAAA;AACxD,uEAA2B;AAAA,sBAAlBM,KAAkB;;AACzB,wBAAI,CAACC,eAAL,CAAqBD,KAArB;AACD;AAHuD;AAAA;AAAA;AAAA;AAAA;AAIzD;AACF,WAfD;AAgBD;AAlMkB;AAAA;AAAA,kCAoMTE,CApMS,EAoMO;AAAA;;AACxB,cAAIlB,OAAO,GAAG;AACZmB,iBAAK,EAAED,CAAC,CAACE,MAAF,CAASC;AADJ,WAAd;AAIA,cAAId,OAAO,GAAG,IAAIpF,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBO,aAAvB,CAAqC,KAAKtF,GAA1C,CAAd;AAEAqF,iBAAO,CAACe,UAAR,CAAmBtB,OAAnB,EAA4B,UAACU,OAAD,EAAUC,MAAV,EAAqB;AAC/CjE,mBAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB+D,OAAzB;;AACA,gBAAIC,MAAM,KAAKxF,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBa,mBAAnB,CAAuCC,EAAtD,EAA0D;AAAA,0DACtCL,OADsC;AAAA;;AAAA;AACxD,uEAA2B;AAAA,sBAAlBM,KAAkB;;AACzB,wBAAI,CAACC,eAAL,CAAqBD,KAArB;AACD;AAHuD;AAAA;AAAA;AAAA;AAAA;AAIzD;AACF,WAPD;AAQD;AAnNkB;AAAA;AAAA,0CAqNqC;AAAA;;AAAA,cAAxCA,KAAwC,uEAAhC7F,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBsB,WAAa;AACtD,cAAMtC,IAAI,GAAG;AACXuC,eAAG,EAAER,KAAK,CAAC/B,IADA;AAEXwC,sBAAU,EAAE,IAAItG,MAAM,CAACC,IAAP,CAAYsG,IAAhB,CAAqB,EAArB,EAAyB,EAAzB,CAFD;AAGXC,kBAAM,EAAE,IAAIxG,MAAM,CAACC,IAAP,CAAYwG,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,CAHG;AAIXC,kBAAM,EAAE,IAAI1G,MAAM,CAACC,IAAP,CAAYwG,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB;AAJG,WAAb;AAOA,cAAIpC,MAAM,GAAG,IAAIrE,MAAM,CAACC,IAAP,CAAYG,MAAhB,CAAuB;AAClCL,eAAG,EAAE,KAAKA,GADwB;AAElC4D,qBAAS,EAAE3D,MAAM,CAACC,IAAP,CAAY2D,SAAZ,CAAsBC,IAFC;AAGlCH,oBAAQ,EAAEmC,KAAK,CAACc,QAAN,CAAezB,QAHS;AAIlCpB,gBAAI,EAAEA;AAJ4B,WAAvB,CAAb;AAOA,eAAKtE,aAAL,CAAmBoH,IAAnB,CAAwBvC,MAAxB;AAEA,cAAIQ,OAAO,GAAG7E,MAAM,CAACC,IAAP,CAAY6E,MAAZ,CAAmBC,kBAAnB,GAAwC;AACpDG,oBAAQ,EAAE,KAAK/E,IAAL,CAAUgF,WAAV;AAD0C,WAAtD;AAIA,cAAI0B,SAAS,GAAG,KAAKC,6BAAL,CACdjC,OAAO,CAACK,QAAR,CAAiBlC,GAAjB,EADc,EAEd6B,OAAO,CAACK,QAAR,CAAiB/B,GAAjB,EAFc,EAGd0C,KAAK,CAACc,QAAN,CAAezB,QAAf,CAAwBlC,GAAxB,EAHc,EAId6C,KAAK,CAACc,QAAN,CAAezB,QAAf,CAAwB/B,GAAxB,EAJc,CAAhB;AAMAkB,gBAAM,CAACJ,WAAP,CAAmB,OAAnB,EAA4B,YAAM;AAChC,gBAAI8C,KAAK,GAAG,EAAZ;;AAEA,gBAAIlB,KAAK,CAACmB,MAAN,CAAa5C,MAAb,GAAsB,CAA1B,EAA6B;AAC3B2C,mBAAK,GAAGlB,KAAK,CAACmB,MAAN,CAAa,CAAb,EAAgBC,MAAhB,CAAuB;AAAEC,wBAAQ,EAAE,GAAZ;AAAiBC,yBAAS,EAAE;AAA5B,eAAvB,CAAR;AACD;;AACD,kBAAI,CAAC9G,UAAL,CACG+G,UADH,sBAC2BL,KAD3B,6FAEKlB,KAAK,CAACwB,IAFX,qBAE0BxB,KAAK,CAACyB,QAFhC,qBAEmDT,SAFnD;;AAGA,kBAAI,CAACxG,UAAL,CAAgB6D,IAAhB,CAAqB,MAAI,CAACnE,GAA1B,EAA+BsE,MAA/B;AACD,WAVD;AAWD;AA3PkB;AAAA;AAAA,wCA6PG;;;;;;;;;AACpB,yBAAK9D,UAAL,GAAkB,IAAlB;AACA,yBAAKC,YAAL,GAAoB,EAApB;;AACA,wBAAI,KAAKC,eAAT,EAA0B;AACxB,2BAAKA,eAAL,CAAqB0D,MAArB,CAA4B,IAA5B;AACD;;;AACW,2BAAM,KAAK9E,SAAL,CAAekI,MAAf,CAAsB;AACtCC,8BAAQ,EAAE,IAD4B;AAEtCC,6BAAO,EAAE;AAF6B,qBAAtB,CAAN;;;AAARC,yB;AAIJ,yBAAKC,oBAAL,GAA4B,KAAKzI,WAAL,CACzB0I,aADyB,GAEzB3G,SAFyB,CAEf,UAAA4G,IAAI,EAAI;AACjBtG,6BAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BqG,IAA9B;;AACA,4BAAI,CAACrH,YAAL,CAAkBoG,IAAlB,CAAuB;AACrB5D,2BAAG,EAAE6E,IAAI,CAAC5E,MAAL,CAAYC,QADI;AAErBC,2BAAG,EAAE0E,IAAI,CAAC5E,MAAL,CAAYG;AAFI,uBAAvB;;AAIA,4BAAI,CAAC0E,UAAL,CAAgB,MAAI,CAACtH,YAArB;AACD,qBATyB,CAA5B;AAUEkH,yBAAK,CAACK,OAAN;;;;;;;;;AACH;AAlRkB;AAAA;AAAA,mCAoRRzJ,IApRQ,EAoRF;AACfiD,iBAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBlD,IAAvB;;AACA,cAAI,KAAKmC,eAAT,EAA0B;AACxB,iBAAKA,eAAL,CAAqB0D,MAArB,CAA4B,IAA5B;AACD;;AAED,cAAI7F,IAAI,CAAC8F,MAAL,GAAc,CAAlB,EAAqB;AACnB,iBAAK3D,eAAL,GAAuB,IAAIT,MAAM,CAACC,IAAP,CAAY+H,QAAhB,CAAyB;AAC9C1J,kBAAI,EAAEA,IADwC;AAE9C2J,sBAAQ,EAAE,IAFoC;AAG9CC,yBAAW,EAAE,SAHiC;AAI9CC,2BAAa,EAAE,GAJ+B;AAK9CC,0BAAY,EAAE;AALgC,aAAzB,CAAvB;AAOA,iBAAK3H,eAAL,CAAqB0D,MAArB,CAA4B,KAAKpE,GAAjC;AACD;AACF;AApSkB;AAAA;AAAA,uCAsSE;;;;;;;AACnB,yBAAKQ,UAAL,GAAkB,KAAlB;AACA,yBAAKoH,oBAAL,CAA0BU,WAA1B;;AACY,2BAAM,KAAKhJ,SAAL,CAAekI,MAAf,CAAsB;AACtCC,8BAAQ,EAAE,IAD4B;AAEtCC,6BAAO,EAAE;AAF6B,qBAAtB,CAAN;;;AAARC,yB;AAIJA,yBAAK,CAACK,OAAN;;;;;;;;;AACD;AA9SkB;AAAA;AAAA,sDAiTWO,IAjTX,EAiTgBC,IAjThB,EAiTqBC,IAjTrB,EAiT0BC,IAjT1B,EAiTgC;AACjD,cAAIC,CAAC,GAAG,IAAR,CADiD,CACnC;;AACd,cAAIC,IAAI,GAAG,KAAKC,OAAL,CAAaJ,IAAI,GAACF,IAAlB,CAAX,CAFiD,CAEZ;;AACrC,cAAIO,IAAI,GAAG,KAAKD,OAAL,CAAaH,IAAI,GAACF,IAAlB,CAAX;AACA,cAAIO,CAAC,GACHC,IAAI,CAACC,GAAL,CAASL,IAAI,GAAC,CAAd,IAAmBI,IAAI,CAACC,GAAL,CAASL,IAAI,GAAC,CAAd,CAAnB,GACAI,IAAI,CAACE,GAAL,CAAS,KAAKL,OAAL,CAAaN,IAAb,CAAT,IAA+BS,IAAI,CAACE,GAAL,CAAS,KAAKL,OAAL,CAAaJ,IAAb,CAAT,CAA/B,GACAO,IAAI,CAACC,GAAL,CAASH,IAAI,GAAC,CAAd,CADA,GACmBE,IAAI,CAACC,GAAL,CAASH,IAAI,GAAC,CAAd,CAHrB;AAKA,cAAIK,CAAC,GAAG,IAAIH,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACK,IAAL,CAAUN,CAAV,CAAX,EAAyBC,IAAI,CAACK,IAAL,CAAU,IAAEN,CAAZ,CAAzB,CAAZ;AACA,cAAIO,CAAC,GAAGX,CAAC,GAAGQ,CAAZ,CAViD,CAUlC;;AACfG,WAAC,GAAGN,IAAI,CAACO,KAAL,CAAWD,CAAC,GAAC,IAAb,CAAJ;AACA,iBAAOA,CAAP;AACD;AA9TkB;AAAA;AAAA,gCAgUXE,GAhUW,EAgUN;AACX,iBAAOA,GAAG,IAAIR,IAAI,CAACS,EAAL,GAAQ,GAAZ,CAAV;AACD;AAlUkB;AAAA;AAAA,4CAoUC3D,KApUD,EAoUM;AACrB,eAAKlG,UAAL,GAAkBkG,KAAlB;AACA,eAAK/F,OAAL,GAAe,KAAf;AACA,cAAI2J,IAAI,GAAG,IAAI,8DAAJ,EAAX;AACAA,cAAI,CAACC,EAAL,GAAU7D,KAAK,CAAC6D,EAAhB;AACAD,cAAI,CAACE,SAAL,IAAkB,CAAlB;AACA,eAAK1K,WAAL,CAAiB2K,oBAAjB,CAAsCH,IAAtC;AAEH;AA5UkB;AAAA;AAAA,mCA6UR5D,KA7UQ,EA6UH;AACd,eAAK/F,OAAL,GAAe,IAAf;AACA,cAAI2J,IAAI,GAAG,IAAI,8DAAJ,EAAX;AACAA,cAAI,CAACC,EAAL,GAAU7D,KAAK,CAAC6D,EAAhB;AACAD,cAAI,CAACE,SAAL,IAAiB,CAAjB;AACA,eAAK1K,WAAL,CAAiB4K,gBAAjB,CAAkCJ,IAAlC;AAED;AApVkB;AAAA;AAAA,uCAsVJK,MAtVI,EAsVIC,MAtVJ,EAsVYC,OAtVZ,EAsVmB;AAEpC,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAACD,OAAO,CAAC5F,MAAR,GAAiB,CAAnC,EAAsC6F,CAAC,EAAvC,EAA0C;AACxC,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAACF,OAAO,CAAC5F,MAAR,GAAiB,CAAjB,GAAqB6F,CAAvC,EAA0CC,CAAC,EAA3C,EAA8C;AAC5C,kBAAI,KAAKpD,6BAAL,CAAmCgD,MAAnC,EAA0CC,MAA1C,EAAiDC,OAAO,CAACE,CAAD,CAAP,CAAWvD,QAAX,CAAoBzB,QAApB,CAA6BlC,GAA7B,EAAjD,EAAoFgH,OAAO,CAACE,CAAD,CAAP,CAAWvD,QAAX,CAAoBzB,QAApB,CAA6B/B,GAA7B,EAApF,IACE,KAAK2D,6BAAL,CAAmCgD,MAAnC,EAA0CC,MAA1C,EAAiDC,OAAO,CAACE,CAAC,GAAC,CAAH,CAAP,CAAavD,QAAb,CAAsBzB,QAAtB,CAA+BlC,GAA/B,EAAjD,EAAsFgH,OAAO,CAACE,CAAC,GAAC,CAAH,CAAP,CAAavD,QAAb,CAAsBzB,QAAtB,CAA+B/B,GAA/B,EAAtF,CADN,EACkI;AAChI,oBAAIgH,GAAG,GAAGH,OAAO,CAACE,CAAC,GAAC,CAAH,CAAjB;AACAF,uBAAO,CAACE,CAAC,GAAC,CAAH,CAAP,GAAeF,OAAO,CAACE,CAAD,CAAtB;AACAF,uBAAO,CAACE,CAAD,CAAP,GAAaC,GAAb;AACD;AACF;AACF;;AACD,iBAAOH,OAAP;AACD;AAnWkB;AAAA;AAAA,qCAqWT;AAAA;;AACR,eAAKvK,cAAL,GAAsB,EAAtB;;AADQ,qCAECwK,CAFD;AAGN,gBAAItF,KAAK,GAAG,IAAI,8DAAJ,EAAZ;AACAA,iBAAK,CAAC+E,EAAN,GAAW,MAAI,CAAC5E,MAAL,CAAYmF,CAAZ,EAAeP,EAA1B;AACA/E,iBAAK,CAAC0C,IAAN,GAAa,MAAI,CAACvC,MAAL,CAAYmF,CAAZ,EAAe5C,IAA5B;AACA1C,iBAAK,CAACyF,UAAN,GAAmB,MAAI,CAACtF,MAAL,CAAYmF,CAAZ,EAAeI,MAAlC;;AAEA,kBAAI,CAACtL,IAAL,CAAUuL,QAAV,CAAmBC,GAAnB,CAAuB,sBAAoB5F,KAAK,CAAC+E,EAAjD,EAAqDc,IAArD,CAA0D,OAA1D,EAAmE9I,IAAnE,CAAwE,UAAS+I,QAAT,EAAmB;AACzF9F,mBAAK,CAACgF,SAAN,GAAkBc,QAAQ,CAACC,GAAT,MAAkBD,QAAQ,CAACC,GAAT,GAAef,SAAnD;AACD,aAFD;;AAGA,kBAAI,CAAClK,cAAL,CAAoBmH,IAApB,CAAyBjC,KAAzB;AAXM;;AAER,eAAK,IAAIsF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnF,MAAL,CAAYV,MAAhC,EAAwC6F,CAAC,EAAzC,EAA4C;AAAA,kBAAnCA,CAAmC;AAU3C;;AACD1I,iBAAO,CAACC,GAAR,CAAY,KAAK/B,cAAjB;AACD;AAnXkB;;AAAA;AAAA,OAArB;;;;cA+BiB;;cACI;;cACI;;cACA;;cACR;;cACM;;cACA;;cACN;;;;AAxBwC,8DAAtD,gEAAU,KAAV,EAAiB;AAAEkL,UAAI,EAAE,wDAAR;AAAoB,gBAAQ;AAA5B,KAAjB,CAAsD,E,wEAAQ,wD,CAAR,G,kBAAA,E,QAAA,E,MAAA;AACrC,8DAAjB,gEAAU,KAAV,CAAiB,E,wEAAY,wD,CAAZ,G,kBAAA,E,YAAA,E,MAAA;AAfP7L,YAAQ,6DALpB,gEAAU;AACT8L,cAAQ,EAAE,UADD;AAETC,cAAQ,EAAR;AAAA;AAAA,wFAFS;;;;AAAA,KAAV,CAKoB,E,+EA+BJ,yE,EACI,4D,EACI,yD,EACA,yE,EACR,uD,EACM,8D,EACA,8D,EACN,6E,EAtCI,GAAR/L,QAAQ,CAAR;;;;;;;;;;;;;;;;ACtBb;AAAA;;;AAAA;AAAA;AAAA;;QAAagM,W,GAAb;AAAA;;AAII,WAAAnB,SAAA,GAAiB,CAAjB;AACH,K;;AAAA","file":"home-home-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n    <img id=\\\"logo\\\" src=\\\".././../assets/logo.png\\\">\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-grid>\\r\\n    <ion-row>\\r\\n      <ion-col size=\\\"9\\\" size-md>\\r\\n        <ion-searchbar placeholder=\\\"Buscar restaurante...\\\" (ionChange)=\\\"findPlace($event)\\\" [debounce]=\\\"500\\\">\\r\\n        </ion-searchbar>\\r\\n      </ion-col>\\r\\n\\r\\n      <ion-col size=\\\"3\\\" size-md>\\r\\n        <ion-button (click)=\\\"startTracking()\\\" color=\\\"success\\\" *ngIf=\\\"!isTracking\\\">\\r\\n          <ion-icon name=\\\"locate\\\" slot=\\\"icon-only\\\"></ion-icon>\\r\\n        </ion-button>\\r\\n\\r\\n        <ion-button (click)=\\\"stopTracking()\\\" color=\\\"warning\\\" *ngIf=\\\"isTracking\\\">\\r\\n          <ion-icon name=\\\"locate\\\" slot=\\\"icon-only\\\"></ion-icon>\\r\\n        </ion-button>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n\\r\\n\\r\\n\\r\\n  <div #map id=\\\"map\\\"></div>\\r\\n  <hr>\\r\\n  <ion-button expand=\\\"block\\\" (click)=\\\"toggleMarker()\\\">¿Dónde estas?</ion-button>\\r\\n  <hr>\\r\\n\\r\\n  <ion-segment>\\r\\n    <ion-segment-button value=\\\"bar\\\" (click)=\\\"showNearby('bar')\\\">\\r\\n      <ion-icon name=\\\"beer\\\"></ion-icon>Bares\\r\\n    </ion-segment-button>\\r\\n    <ion-segment-button value=\\\"cafeteria\\\" (click)=\\\"showNearby('cafe')\\\">\\r\\n      <ion-icon name=\\\"cafe\\\"></ion-icon>Cafeterias\\r\\n    </ion-segment-button>\\r\\n    <ion-segment-button value=\\\"restaurante\\\" (click)=\\\"showNearby('restaurant')\\\">\\r\\n      <ion-icon name=\\\"restaurant\\\"></ion-icon>Restaurantes\\r\\n    </ion-segment-button>\\r\\n  </ion-segment>\\r\\n\\r\\n\\r\\n\\r\\n  <ion-list *ngFor=\\\"let place of locales_places; let i = index\\\">\\r\\n    <ion-item *ngIf=\\\"i < 3\\\">\\r\\n      <ion-card>\\r\\n        <ion-card-header>\\r\\n          <ion-card-title>{{place.name}}</ion-card-title>\\r\\n        </ion-card-header>\\r\\n        <ion-card-content>\\r\\n           Valoracion: {{place.rating}}/5 - \\r\\n           Ocupacion: {{place.ocupacion}}\\r\\n           <ion-button expand=\\\"block\\\" (click)=\\\"insertar_este_lugar(place)\\\" *ngIf = \\\"mostrar\\\">¿Estás aquí?</ion-button>\\r\\n           \\r\\n        </ion-card-content>\\r\\n      </ion-card>\\r\\n    </ion-item>\\r\\n  </ion-list>\\r\\n  <ion-button expand=\\\"block\\\" color = \\\"danger\\\" (click)=\\\"salirLocal(restaurant)\\\" *ngIf = \\\"!mostrar\\\">No estoy</ion-button>\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { HomePage } from './home.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HomePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class HomePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HomePage } from './home.page';\r\nimport { HomePageRoutingModule } from './home-routing.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HomePageRoutingModule\r\n  ],\r\n  declarations: [HomePage]\r\n})\r\nexport class HomePageModule {}\r\n","export default \"#map {\\n  height: 50%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaG9tZS9EOlxcUHJhY3RpY2FzXFxhcGxpY2FjaW9uX2ZpbmFsXFxzZWxfZ29fZWF0XFxnb2VhdC9zcmNcXGFwcFxcaG9tZVxcaG9tZS5wYWdlLnNjc3MiLCJzcmMvYXBwL2hvbWUvaG9tZS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxXQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9ob21lL2hvbWUucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI21hcCB7XHJcbiAgaGVpZ2h0OiA1MCU7XHJcbn1cclxuXHJcblxyXG4iLCIjbWFwIHtcbiAgaGVpZ2h0OiA1MCU7XG59Il19 */\";","import { Component, OnInit } from '@angular/core';\r\nimport { ViewChild, ElementRef } from '@angular/core';\r\nimport { NavController, ToastController, AlertController } from '@ionic/angular';\r\nimport { AuthService } from '../auth.service';\r\nimport { Usuario } from '../registro/usuario.model';\r\nimport { Router } from '@angular/router';\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\nimport { Geolocation, GeolocationOptions, Geoposition, PositionError } from '@ionic-native/geolocation/ngx';\r\nimport { Subscription } from 'rxjs';\r\nimport { Platform } from '@ionic/angular';\r\nimport { InAppBrowser } from '@ionic-native/in-app-browser/ngx';\r\nimport {Restaurante} from './restaurante.model';\r\nimport { AngularFireDatabase } from 'angularfire2/database';\r\n\r\ndeclare var google: any;\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: 'home.page.html',\r\n  styleUrls: ['home.page.scss'],\r\n})\r\nexport class HomePage implements OnInit {\r\n  \r\n  count_position:any = 0;\r\n  options: GeolocationOptions;\r\n  currentPos: Geoposition;\r\n  userEmail: string;\r\n  places: Array<any>;\r\n  place_markers: Array<any> = [];\r\n  locales_places: Array<any> = [];\r\n  usuario: Usuario = new Usuario();\r\n  restaurant: Restaurante = new Restaurante();\r\n  public isError = false;\r\n  public isLogged = false;\r\n  public mostrar = true;\r\n  @ViewChild('map', { read: ElementRef, static: false }) mapRef: ElementRef;\r\n  @ViewChild('map') mapElement: ElementRef;\r\n  map = google.maps.Map;\r\n  home = google.maps.Marker;\r\n  infowindow = new google.maps.InfoWindow();\r\n  isTracking = false;\r\n  trackedRoute = [];\r\n  currentMapTrack = null;\r\n  positionSubscription: Subscription;\r\n  locationWatchStarted: boolean;\r\n  locationSubscription: any;\r\n  start = '';\r\n  end = '';\r\n  direction = google.maps.DirectionsResult;\r\n  restaurante: Restaurante\r\n\r\n  constructor(\r\n    public afDB: AngularFireDatabase,\r\n    private navCtrl: NavController,\r\n    private authService: AuthService,\r\n    private geolocation: Geolocation,\r\n    private plt: Platform,\r\n    private alertCtrl: AlertController,\r\n    private toastCtrl: ToastController,\r\n    private iab: InAppBrowser\r\n    ) { }\r\n\r\n  ionViewDidEnter() {\r\n    this.loadMap();\r\n    this.loadUserPosition();\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n    this.authService.userDetails().subscribe(res => {\r\n      if (res !== null) {\r\n        this.userEmail = res.email;\r\n      } else {\r\n        this.navCtrl.navigateBack('');\r\n      }\r\n    }, err => {\r\n      console.log('err', err);\r\n    });\r\n  }\r\n  logout() {\r\n    this.authService.logoutUser()\r\n      .then(res => {\r\n        console.log(res);\r\n        this.navCtrl.navigateBack('');\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n      })\r\n  }\r\n  loadMap() {\r\n    let latLng = new google.maps.LatLng(40.0000000, -4.0000000);\r\n\r\n    let styles = google.maps.MapTypeStyle = [\r\n      {\r\n        featureType: 'poi',\r\n        stylers: [\r\n          {\r\n            visibility: 'off'\r\n          }\r\n        ]\r\n      }\r\n    ];\r\n\r\n    let mapOptions = google.maps.MapOptions = {\r\n      center: latLng,\r\n      zoom: 5,\r\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n      styles: styles,\r\n      mapTypeControl: false\r\n    };\r\n\r\n    this.map = new google.maps.Map(this.mapElement.nativeElement, mapOptions);\r\n  }\r\n\r\n  loadUserPosition() {\r\n    this.plt.ready().then(() => {\r\n      this.geolocation.getCurrentPosition().then(resp => {\r\n        const lat = resp.coords.latitude;\r\n        const lng = resp.coords.longitude;\r\n        this.focusMap(lat, lng);\r\n        this.addMarker(\r\n          lat,\r\n          lng,\r\n          'Tu posición'\r\n        );\r\n      });\r\n    });\r\n  }\r\n\r\n  focusMap(lat, lng) {\r\n    let latLng = new google.maps.LatLng(lat, lng);\r\n    this.map.setCenter(latLng);\r\n    this.map.setZoom(15);\r\n  }\r\n\r\n  addMarker(lat, lng, info) {\r\n    let latLng = new google.maps.LatLng(lat, lng);\r\n\r\n    this.home = new google.maps.Marker({\r\n      map: this.map,\r\n      position: latLng,\r\n      animation: google.maps.Animation.DROP,\r\n      icon:\r\n        'https://developers.google.com/maps/documentation/javascript/examples/full/images/library_maps.png'\r\n    });\r\n\r\n    let infoWindow = new google.maps.InfoWindow({\r\n      content: info\r\n    });\r\n    this.home.addListener('click', () => {\r\n      infoWindow.open(this.map, this.home);\r\n    });\r\n  }\r\n\r\n  removeMarker() {\r\n    this.home.setMap(null);\r\n  }\r\n\r\n  remove_place_markers() {\r\n    if(this.place_markers.length > 0){\r\n      for (let marker of this.place_markers){\r\n        marker.setMap(null);\r\n      }\r\n    }\r\n    \r\n  }\r\n\r\n  toggleMarker() {\r\n    if (this.home.getAnimation() !== null) {\r\n      this.home.setAnimation(null);\r\n    } else {\r\n      this.home.setAnimation(google.maps.Animation.BOUNCE);\r\n    }\r\n  }\r\n\r\n  private setCurrentLocation() {\r\n    let my_coords:Array<any> = [];\r\n    if ('geolocation' in navigator) {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        my_coords[0] = position.coords.latitude;\r\n        my_coords[1] = position.coords.longitude;\r\n\r\n      });\r\n    }\r\n    return my_coords;\r\n  }\r\n\r\n  showNearby(local) {\r\n    if(this.place_markers){\r\n      this.remove_place_markers();\r\n    }\r\n    \r\n    let request = google.maps.places.PlaceSearchRequest = {\r\n      type: [local],\r\n      radius: 400,\r\n      location: this.home.getPosition()\r\n    };\r\n    \r\n    let service = new google.maps.places.PlacesService(this.map);\r\n    service.nearbySearch(request, (results, status) => {\r\n      this.places=results;\r\n      let request = google.maps.places.PlaceSearchRequest = {\r\n        location: this.home.getPosition()\r\n      };\r\n      // console.log(this.places);\r\n\r\n      this.places = this.distance_order(request.location.lat(), request.location.lng(), this.places);\r\n      this.lista_rest();\r\n      // console.log(this.places);\r\n      if (status === google.maps.places.PlacesServiceStatus.OK) {\r\n        for (let place of results) {\r\n          this.addNearbyMarker(place);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  findPlace(e: CustomEvent) {\r\n    let request = {\r\n      query: e.detail.value\r\n    };\r\n\r\n    let service = new google.maps.places.PlacesService(this.map);\r\n\r\n    service.textSearch(request, (results, status) => {\r\n      console.log('results: ', results);\r\n      if (status === google.maps.places.PlacesServiceStatus.OK) {\r\n        for (let place of results) {\r\n          this.addNearbyMarker(place);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  addNearbyMarker(place = google.maps.places.PlaceResult) {\r\n    const icon = {\r\n      url: place.icon,\r\n      scaledSize: new google.maps.Size(25, 25),\r\n      origin: new google.maps.Point(0, 0),\r\n      anchor: new google.maps.Point(0, 0)\r\n    };\r\n\r\n    let marker = new google.maps.Marker({\r\n      map: this.map,\r\n      animation: google.maps.Animation.DROP,\r\n      position: place.geometry.location,\r\n      icon: icon\r\n    });\r\n\r\n    this.place_markers.push(marker);\r\n\r\n    let request = google.maps.places.PlaceSearchRequest = {\r\n      location: this.home.getPosition()\r\n    };\r\n\r\n    let distancia = this.getDistanceFromLatLonInMeters(\r\n      request.location.lat(),\r\n      request.location.lng(),\r\n      place.geometry.location.lat(),\r\n      place.geometry.location.lng());\r\n\r\n    marker.addListener('click', () => {\r\n      let photo = '';\r\n\r\n      if (place.photos.length > 0) {\r\n        photo = place.photos[0].getUrl({ maxWidth: 100, maxHeight: 100 });\r\n      }\r\n      this.infowindow\r\n        .setContent(`<img src=\"${photo}\" style=\"width: 100%;max-height: 100px;object-fit: contain;\"/><br>\r\n      <b>${place.name}</b><br>${place.vicinity}</b><br>${distancia} metros`);\r\n      this.infowindow.open(this.map, marker);\r\n    });\r\n  }\r\n\r\n  async startTracking() {\r\n    this.isTracking = true;\r\n    this.trackedRoute = [];\r\n    if (this.currentMapTrack) {\r\n      this.currentMapTrack.setMap(null);\r\n    }\r\n    let toast = await this.toastCtrl.create({\r\n      duration: 3000,\r\n      message: 'Iniciando trackeo...'});\r\n\r\n    this.positionSubscription = this.geolocation\r\n      .watchPosition()\r\n      .subscribe(data => {\r\n        console.log('new position: ', data);\r\n        this.trackedRoute.push({\r\n          lat: data.coords.latitude,\r\n          lng: data.coords.longitude\r\n        });\r\n        this.redrawPath(this.trackedRoute);\r\n      });\r\n      toast.present();\r\n  }\r\n\r\n  redrawPath(path) {\r\n    console.log('paint: ', path);\r\n    if (this.currentMapTrack) {\r\n      this.currentMapTrack.setMap(null);\r\n    }\r\n\r\n    if (path.length > 1) {\r\n      this.currentMapTrack = new google.maps.Polyline({\r\n        path: path,\r\n        geodesic: true,\r\n        strokeColor: '#ff00ff',\r\n        strokeOpacity: 1.0,\r\n        strokeWeight: 3\r\n      });\r\n      this.currentMapTrack.setMap(this.map);\r\n    }\r\n  }\r\n\r\n  async stopTracking() {\r\n    this.isTracking = false;\r\n    this.positionSubscription.unsubscribe();\r\n    let toast = await this.toastCtrl.create({\r\n      duration: 3000,\r\n      message: 'Has dejado de tracker...'\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n\r\n  getDistanceFromLatLonInMeters(lat1,lon1,lat2,lon2) {\r\n    var R = 6371; // Radius of the earth in km\r\n    var dLat = this.deg2rad(lat2-lat1);  // deg2rad below\r\n    var dLon = this.deg2rad(lon2-lon1); \r\n    var a = \r\n      Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n      Math.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) * \r\n      Math.sin(dLon/2) * Math.sin(dLon/2)\r\n      ; \r\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \r\n    var d = R * c; // Distance in km\r\n    d = Math.round(d*1000);\r\n    return d;\r\n  }\r\n  \r\n  deg2rad(deg) {\r\n    return deg * (Math.PI/180)\r\n  }\r\n  \r\n  insertar_este_lugar(place){\r\n      this.restaurant = place;\r\n      this.mostrar = false;\r\n      let rest = new Restaurante();\r\n      rest.id = place.id;\r\n      rest.ocupacion += 1;\r\n      this.authService.insertar_restaurante(rest);\r\n     \r\n  }\r\n  salirLocal(place){\r\n    this.mostrar = true;\r\n    let rest = new Restaurante();\r\n    rest.id = place.id;\r\n    rest.ocupacion -=1;\r\n    this.authService.borrar_ocupacion(rest);\r\n     \r\n  }\r\n\r\n  distance_order(my_lat, my_lng, lugares){\r\n    \r\n    for (let i = 0; i<lugares.length - 1; i++){\r\n      for (let j = 0; j<lugares.length - 1 - i; j++){\r\n        if (this.getDistanceFromLatLonInMeters(my_lat,my_lng,lugares[j].geometry.location.lat(),lugares[j].geometry.location.lng()) \r\n            > this.getDistanceFromLatLonInMeters(my_lat,my_lng,lugares[j+1].geometry.location.lat(),lugares[j+1].geometry.location.lng())){\r\n          let aux = lugares[j+1];\r\n          lugares[j+1] = lugares[j];\r\n          lugares[j] = aux;\r\n        }\r\n      }\r\n    }\r\n    return lugares;\r\n  }\r\n\r\n  lista_rest(){\r\n    this.locales_places = [];\r\n    for (let i = 0; i < this.places.length; i++){\r\n      let local = new Restaurante();\r\n      local.id = this.places[i].id;\r\n      local.name = this.places[i].name;\r\n      local.valoracion = this.places[i].rating;\r\n      \r\n      this.afDB.database.ref(\"establecimientos/\"+local.id).once('value').then(function(snapshot) {\r\n        local.ocupacion = snapshot.val() && snapshot.val().ocupacion;\r\n      });\r\n      this.locales_places.push(local);\r\n    }\r\n    console.log(this.locales_places);\r\n  }\r\n\r\n  \r\n}","export class Restaurante{\r\n    id?:string;\r\n    name?:string;\r\n    valoracion?:number;\r\n    ocupacion?:any = 0;\r\n};"]}